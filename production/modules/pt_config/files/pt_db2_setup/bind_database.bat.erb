@ECHO OFF
set DB2CLP=**$$**

set DB2_TYPE="<%= db2_type %>"
set UNICODE_DB=<%= unicode_db %>
set DB2_SQLLIB_DIR="<%= db2_sqllib_dir %>"

db2 update cli cfg for section COMMON using IGNOREWARNINGS "1"
db2 update cli cfg for section COMMON using DISABLEKEYSETCURSOR "1"

db2 CONNECT TO <%= db2_database_name %> USER <%= db2_user_name %> using <%= db2_user_pwd %>
IF %ERRORLEVEL% EQU 0 (
  IF %DB2_TYPE% == "DB2ODBC" (
    IF %UNICODE_DB% EQU 1 (
      db2 bind <%= ps_home_dir %>\bin\sqr\db2\binw\dbcalls.bnd encoding unicode blocking all grant public sqlerror continue
    ) ELSE (
      db2 bind <%= ps_home_dir %>\bin\sqr\db2\binw\dbcalls.bnd blocking all grant public sqlerror continue
    )
    cd %DB2_SQLLIB_DIR%\bnd && db2 bind @ddcsmvs.lst blocking all sqlerror continue grant public
  ) ELSE (
    db2 bind <%= ps_home_dir %>\bin\sqr\dbx\binw\dbcalls.bnd
  )
  cd %DB2_SQLLIB_DIR%\bnd && db2 bind @db2cli.lst grant public
  cd %DB2_SQLLIB_DIR%\bnd && db2 bind @db2ubind.lst grant public
  ECHO
)
